{% extends "base.html" %}
{% block content %}

<section class="swap-requests-list">
    <h2 class="page-title">Swap Requests for Your Items</h2>

    {% if requests %}
        {% for req in requests %}
        <div class="swap-request-card">

            <div class="request-info">
                <p><strong>Type:</strong> {{ req.request_type }}</p>
                <p><strong>Item:</strong> {{ req.item_title }}</p>
                <p><strong>Name:</strong> {{ req.requester_name }}</p>
                <p><strong>Email:</strong> {{ req.requester_email }}</p>
                <p><strong>Phone:</strong> {{ req.requester_phone }}</p>
                <p><strong>{% if req.request_type == 'Swap' %}Offered Item{% else %}Pickup Address{% endif %}:</strong> {{ req.offered_item }}</p>
            </div>

            <div class="request-actions">
                {% if req.request_type == 'Swap' %}
                    <button type="submit" class="btn-decline">
                        <a href="{{ url_for('chat_with_user', user_id=req.user_id) }}" class="btn-chat">Chat</a>
                    </button>
                    
                    {% if req.status != 'Accepted' and req.status != 'Declined' %}
                    <form action="{{ url_for('accept_swap', request_id=req.request_id) }}" method="POST" style="display:inline;">
                        <button type="submit" class="btn-accept">Accept</button>
                    </form>
                    <form action="{{ url_for('decline_swap', request_id=req.request_id) }}" method="POST" style="display:inline;">
                        <button type="submit" class="btn-decline">Decline</button>
                    </form>
                    {% else %}
                        <span>Status: {{ req.status }}</span>
                    {% endif %}
                {% else %}
                    {% if req.status != 'completed' %}
                    <form action="{{ url_for('complete_donation', donation_id=req.request_id) }}" method="POST">
                        <button type="submit" class="btn-complete">Accept</button>
                    </form>
                    {% else %}
                        <span>Status: Completed</span>
                    {% endif %}
                {% endif %}
            </div>

        </div>
        {% endfor %}
    {% else %}
        <p class="empty-text">No swap requests for your items yet.</p>
    {% endif %}
</section>

{% endblock %}
